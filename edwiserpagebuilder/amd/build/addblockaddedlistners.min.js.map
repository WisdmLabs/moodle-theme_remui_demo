{"version":3,"file":"addblockaddedlistners.min.js","sources":["../src/addblockaddedlistners.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-console*/\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Show an add block modal instead of doing it on a separate page.\n *\n * @module     theme_remui/addblockaddedlistners\n * @copyright  2016 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport { get_string as getString } from 'core/str';\nimport Ajax from 'core/ajax';\nimport $ from 'jquery';\nimport { exception as displayException } from 'core/notification';\n\nconst SELECTORS = {\n    ADD_BLOCK: '[data-key=\"addblock\"]',\n    DEFAULTBLOCKWRAPPER: '.modal-body  .default-blocks-wrapper',\n    ADDBLOCKGRIDVIEW: '.add-block-grid-view',\n    ADDBLOCKLISTVIEW: '.add-block-list-view',\n    DYNAMICBLOCKSWRAPPER: 'dynamic-blocks-wrapper',\n    STATICBLOCKSWRAPPER: 'static-blocks-wrapper',\n    BLOCKLAYOUTWRAPPER: 'block-layout-wrapper'\n\n};\n\nlet activeclassview = 'grid-view';\nlet notactiveclassview = 'list-view';\nlet userprefclass = SELECTORS.ADDBLOCKGRIDVIEW;\nlet usernotprefclass = SELECTORS.ADDBLOCKLISTVIEW;\nlet templatefile = 'theme_remui/add_block_body_cards';\nlet csscontent = '';\nlet prefview = 'card';\nlet tabpref = 'edwadvancedblocks';\nlet edwiseradvancedblocktab = '.edwiseradvancedblocktab';\nlet moodleblockstab = '.moodleblockstab';\nlet activeadvancedtab = true;\n/**\n * Initialize events\n */\nfunction init() {\n    let scrollInterval;\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('.add-block-grid-view');\n        templatefile = 'theme_remui/add_block_body_cards';\n        if (selecteditem) {\n            activeclassview = 'grid-view';\n            notactiveclassview = 'list-view';\n            userprefclass = SELECTORS.ADDBLOCKGRIDVIEW;\n            usernotprefclass = SELECTORS.ADDBLOCKLISTVIEW;\n            $(userprefclass).addClass('active');\n            $(usernotprefclass).removeClass('active');\n            $(SELECTORS.DEFAULTBLOCKWRAPPER).removeClass(notactiveclassview).addClass(activeclassview);\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('.add-block-list-view');\n        if (selecteditem) {\n            activeclassview = 'list-view';\n            notactiveclassview = 'grid-view';\n            userprefclass = SELECTORS.ADDBLOCKLISTVIEW;\n            usernotprefclass = SELECTORS.ADDBLOCKGRIDVIEW;\n            $(userprefclass).addClass('active');\n            $(usernotprefclass).removeClass('active');\n            $(SELECTORS.DEFAULTBLOCKWRAPPER).removeClass(notactiveclassview).addClass(activeclassview);\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('.edwiseradvancedblocktab');\n        if (selecteditem) {\n            activeadvancedtab = true;\n            $('.moodleblock').addClass('d-none');\n            $('.advanceblockblocks').removeClass('d-none');\n            $('.advancedblocktab').addClass('active show');\n            $('.moodleblocktab').removeClass('active show');\n            $('.action-buttons-modal').removeClass('d-none');\n            $('.edw-tabs-navigation.edwiser-custom-blocks-nav').removeClass('d-none');\n            // The variable edwremuitheninfo is comming from theme using data for js\n            if ( typeof edwremuithemeinfo !== 'undefined' && edwremuithemeinfo == 'available') {\n                $('.modal-subheader').addClass('p-mb-2').removeClass('p-mb-6');\n            }\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('.edwmoodleblockstab');\n        if (selecteditem) {\n            activeadvancedtab = false;\n            $('.moodleblock').removeClass('d-none');\n            $('.advanceblockblocks').addClass('d-none');\n            $('.moodleblocktab').addClass('active show');\n            $('.advancedblocktab').removeClass('active show');\n            $('.action-buttons-modal').addClass('d-none');\n            $('.modal-subheader').addClass('p-mb-6').removeClass('p-mb-2');\n            $('.edw-tabs-navigation.edwiser-custom-blocks-nav').addClass('d-none');\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('#static-blocks-btn');\n        if (selecteditem) {\n            $(SELECTORS.DEFAULTBLOCKWRAPPER).removeClass(`${SELECTORS.DYNAMICBLOCKSWRAPPER} ${SELECTORS.BLOCKLAYOUTWRAPPER}`).addClass(SELECTORS.STATICBLOCKSWRAPPER);\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('#dynamic-blocks-btn');\n        if (selecteditem) {\n            $(SELECTORS.DEFAULTBLOCKWRAPPER).removeClass(`${SELECTORS.STATICBLOCKSWRAPPER} ${SELECTORS.BLOCKLAYOUTWRAPPER}`).addClass(SELECTORS.DYNAMICBLOCKSWRAPPER);\n        }\n    })\n\n    document.addEventListener('click', e => {\n        const selecteditem = e.target.closest('#layout-blocks-btn');\n        if (selecteditem) {\n            $(SELECTORS.DEFAULTBLOCKWRAPPER).removeClass(`${SELECTORS.DYNAMICBLOCKSWRAPPER} ${SELECTORS.STATICBLOCKSWRAPPER}`).addClass(SELECTORS.BLOCKLAYOUTWRAPPER);\n        }\n    })\n\n    // On mouse enter of block layout image\n    $(document).on('mouseenter', \".addblock-modal-body .block-page-layout\", function () {\n\n        // Get card height \n        const cardHeight = $(this).find(\".card\").height();\n\n        // Get card image \n        const img = $(this).find(\".card img\");\n\n        // Get image height\n        const imgHeight = img.height();\n\n        // Calculate scroll height by subtracting card height from image height (adding 40px for ensuriing smooth scroll)\n        let scrollHeight = imgHeight - cardHeight + 40;\n\n        // Remove animation\n        img.css(\"animation\", \"unset\");\n\n        // If scroll height is greater than 0\n        if (scrollHeight > 0) {\n\n            // Calculate scroll time\n            let scrolltime = scrollHeight / 100;\n\n            // Set transition\n            img.css(\"transition\", `top ${scrolltime}s ease-in-out`);\n\n            // Set initial top position\n            img.css(\"top\", `${-scrollHeight}px`);\n\n            // On transition end, set top to 0\n            img.one('transitionend', function() {\n                img.css(\"top\", `0px`);\n            });\n\n            // Set interval to repeat scroll animation\n            scrollInterval = setInterval(function() {\n\n                img.css(\"top\", `${-scrollHeight}px`);\n\n                img.one('transitionend', function() {\n                    img.css(\"top\", `0px`);\n                });\n\n            }, scrolltime * 2000);\n        }\n    });\n\n    $(document).on('mouseleave', \".addblock-modal-body .block-page-layout\", function() {\n        const img = $(this).find(\".card img\");\n        img.css(\"transition\", \"unset\");\n        img.css(\"top\", `0px`);\n\n        clearInterval(scrollInterval);\n    });\n}\n\nexport {\n    init\n}\n"],"names":["scrollInterval","document","addEventListener","e","selecteditem","target","closest","templatefile","activeclassview","notactiveclassview","userprefclass","SELECTORS","usernotprefclass","addClass","removeClass","activeadvancedtab","edwremuithemeinfo","on","cardHeight","this","find","height","img","scrollHeight","css","scrolltime","one","setInterval","clearInterval"],"mappings":";;;;;;;0FAuDQA,eACJC,SAASC,iBAAiB,SAASC,UACzBC,aAAeD,EAAEE,OAAOC,QAAQ,wBACtCC,aAAe,mCACXH,eACAI,gBAAkB,YAClBC,mBAAqB,YACrBC,cAAgBC,2BAChBC,iBAAmBD,+CACjBD,eAAeG,SAAS,8BACxBD,kBAAkBE,YAAY,8BAC9BH,+BAA+BG,YAAYL,oBAAoBI,SAASL,qBAIlFP,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,0BAElCE,gBAAkB,YAClBC,mBAAqB,YACrBC,cAAgBC,2BAChBC,iBAAmBD,+CACjBD,eAAeG,SAAS,8BACxBD,kBAAkBE,YAAY,8BAC9BH,+BAA+BG,YAAYL,oBAAoBI,SAASL,qBAIlFP,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,8BAElCS,mBAAoB,sBAClB,gBAAgBF,SAAS,8BACzB,uBAAuBC,YAAY,8BACnC,qBAAqBD,SAAS,mCAC9B,mBAAmBC,YAAY,mCAC/B,yBAAyBA,YAAY,8BACrC,kDAAkDA,YAAY,UAE9B,oBAAtBE,mBAA0D,aAArBA,uCAC3C,oBAAoBH,SAAS,UAAUC,YAAY,cAKjEb,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,yBAElCS,mBAAoB,sBAClB,gBAAgBD,YAAY,8BAC5B,uBAAuBD,SAAS,8BAChC,mBAAmBA,SAAS,mCAC5B,qBAAqBC,YAAY,mCACjC,yBAAyBD,SAAS,8BAClC,oBAAoBA,SAAS,UAAUC,YAAY,8BACnD,kDAAkDD,SAAS,cAIrEZ,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,2CAEhCK,+BAA+BG,sBAAeH,2CAAkCA,+BAAgCE,SAASF,kCAInIV,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,4CAEhCK,+BAA+BG,sBAAeH,0CAAiCA,+BAAgCE,SAASF,mCAIlIV,SAASC,iBAAiB,SAASC,IACVA,EAAEE,OAAOC,QAAQ,2CAEhCK,+BAA+BG,sBAAeH,2CAAkCA,gCAAiCE,SAASF,qDAKlIV,UAAUgB,GAAG,aAAc,2CAA2C,iBAG9DC,YAAa,mBAAEC,MAAMC,KAAK,SAASC,SAGnCC,KAAM,mBAAEH,MAAMC,KAAK,iBAMrBG,aAHcD,IAAID,SAGSH,WAAa,MAG5CI,IAAIE,IAAI,YAAa,SAGjBD,aAAe,EAAG,KAGdE,WAAaF,aAAe,IAGhCD,IAAIE,IAAI,2BAAqBC,6BAG7BH,IAAIE,IAAI,iBAAWD,oBAGnBD,IAAII,IAAI,iBAAiB,WACrBJ,IAAIE,IAAI,gBAIZxB,eAAiB2B,aAAY,WAEzBL,IAAIE,IAAI,iBAAWD,oBAEnBD,IAAII,IAAI,iBAAiB,WACrBJ,IAAIE,IAAI,kBAGA,IAAbC,oCAITxB,UAAUgB,GAAG,aAAc,2CAA2C,iBAC9DK,KAAM,mBAAEH,MAAMC,KAAK,aACzBE,IAAIE,IAAI,aAAc,SACtBF,IAAIE,IAAI,aAERI,cAAc5B,sGA/JhBW,8BAEmB,uCAFnBA,2BAGgB,uBAHhBA,2BAIgB,uBAJhBA,+BAKoB,yBALpBA,8BAMmB,wBANnBA,6BAOkB,2BAIpBH,gBAAkB,YAClBC,mBAAqB,YACrBC,cAAgBC,2BAChBC,iBAAmBD,2BACnBJ,aAAe,mCAMfQ,mBAAoB"}